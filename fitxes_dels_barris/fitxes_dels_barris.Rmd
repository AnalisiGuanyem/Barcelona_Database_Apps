---
title: "Perfil de barris o districte"
author: "Grup d'Anàlisi de Dades"
date: "31/01/2015"
output:
  pdf_document:
    highlight: zenburn
---

```{r knitr_options, include=FALSE, echo=FALSE, results="hide"}
# Installing 'rmarkdown' package if necessary:
if(!require("rmarkdown")) install.packages("rmarkdown", repos="http://cran.us.r-project.org")
library(rmarkdown)
if(!require("knitr")) install.packages("knitr", repos="http://cran.us.r-project.org")
library(knitr)
opts_chunk$set(fig.width=12, fig.height=4, warning=FALSE, message=FALSE)
options(digits = 3)
```

```{r, echo=FALSE, results="hide"}
# Obtaining and loading the dataset
download.file("https://raw.githubusercontent.com/AnalisiGuanyem/Barcelona_Database/master/info_per_barris/info_per_barris_data.csv", 
              destfile="info_per_barris_data.csv", method="wget")
ciutat <- read.csv("info_per_barris_data.csv", header = TRUE, sep = ";", dec = ".")
file.remove("info_per_barris_data.csv")
```

```{r, echo=FALSE, results="hide"}
# Choosing the analyzed district/neighborhood
analyzing <- 'barri'    # write 'districte' or 'barri'
num_analyzed <- 17      # visit 'https://github.com/AnalisiGuanyem/Barcelona_Database#readme'
                        # to chose the number of district or neighborhood

# Name of the  district/neighborhood (automatic):
if (analyzing == "barri") {
  name_analyzed <- ciutat[num_analyzed,3]
} else if (analyzing == "districte") {
  if (num_analyzed==1) { name_analyzed <- "Ciutat Vella" }
  if (num_analyzed==2) { name_analyzed <- "Eixample" }
  if (num_analyzed==3) { name_analyzed <- "Sants-Montjuïc" }
  if (num_analyzed==4) { name_analyzed <- "Les Corts" }
  if (num_analyzed==5) { name_analyzed <- "Sarrià - Sant Gervasi" }
  if (num_analyzed==6) { name_analyzed <- "Gràcia" }
  if (num_analyzed==7) { name_analyzed <- "Horta-Guinardó" }
  if (num_analyzed==8) { name_analyzed <- "Nou Barris" }
  if (num_analyzed==9) { name_analyzed <- "Sant Andreu" }
  if (num_analyzed==10) { name_analyzed <- "Sant Martí" }
  
  # Analyzed neighborhoods in case of choosing 'district'
  num_analyzed <- which(ciutat[,1]==num_analyzed, arr.ind = TRUE)
  
} else {
  quit("no")
}

# Small dataset being analyzed (the neghborhood or the whole district):
barris <- ciutat[num_analyzed,]
```

# `r toupper(name_analyzed)`



## Dades polítiques

 **...** | **al `r analyzing`** | **a la ciutat**
------------- | ------------- | -------------
 |  |  
 Abstenció eleccions generals 2011 | `r round(100*sum(barris$abstencio_g11)/sum(barris$electors_g11),1)` | `r round(100*sum(ciutat$abstencio_g11)/sum(ciutat$electors_g11),1)`
 |  |  
 Abstenció eleccions locals 2011 | `r round(100*(1-(sum(barris$votants_l11)/sum(barris$electors_l11))),1)` | `r round(100*(1-(sum(ciutat$votants_l11)/sum(ciutat$electors_l11))),1)`
 Vot a CIU eleccions locals 2011 | `r round(100*sum(barris$ciu_l11)/sum(barris$votants_l11),1)` | `r round(100*sum(ciutat$ciu_l11)/sum(ciutat$votants_l11),1)` 
 Vot a PSC eleccions locals 2011 | `r round(100*sum(barris$psc_l11)/sum(barris$votants_l11),1)` | `r round(100*sum(ciutat$psc_l11)/sum(ciutat$votants_l11),1)`
 Vot a PP eleccions locals 2011 | `r round(100*sum(barris$pp_l11)/sum(barris$votants_l11),1)` | `r round(100*sum(ciutat$pp_l11)/sum(ciutat$votants_l11),1)`
 Vot a ICV eleccions locals 2011 | `r round(100*sum(barris$icv_l11)/sum(barris$votants_l11),1)` | `r round(100*sum(ciutat$icv_l11)/sum(ciutat$votants_l11),1)`
 Vot a ERC eleccions locals 2011 | `r round(100*sum(barris$erc_l11)/sum(barris$votants_l11),1)` | `r round(100*sum(ciutat$erc_l11)/sum(ciutat$votants_l11),1)`
 |  |  
 Vot a CIU eleccions europees 2014 | `r round(100*sum(barris$ciu_eu14)/sum(barris$votants_eu14),1)` | `r round(100*sum(ciutat$ciu_eu14)/sum(ciutat$votants_eu14),1)` 
 Vot a PSC eleccions europees 2014 | `r round(100*sum(barris$psc_eu14)/sum(barris$votants_eu14),1)` | `r round(100*sum(ciutat$psc_eu14)/sum(ciutat$votants_eu14),1)`
 Vot a PP eleccions europees 2014 | `r round(100*sum(barris$pp_eu14)/sum(barris$votants_eu14),1)` | `r round(100*sum(ciutat$pp_eu14)/sum(ciutat$votants_eu14),1)`
 Vot a ICV eleccions europees 2014 | `r round(100*sum(barris$icv_eu14)/sum(barris$votants_eu14),1)` | `r round(100*sum(ciutat$icv_eu14)/sum(ciutat$votants_eu14),1)`
 Vot a ERC eleccions europees 2014 | `r round(100*sum(barris$erc_eu14)/sum(barris$votants_eu14),1)` | `r round(100*sum(ciutat$erc_eu14)/sum(ciutat$votants_eu14),1)`
 Vot a Podemos eleccions europees 2014 | `r round(100*sum(barris$pocem_eu14)/sum(barris$votants_eu14),1)` | `r round(100*sum(ciutat$pocem_eu14)/sum(ciutat$votants_eu14),1)`
  |  |  

 
## Dades socio-econòmiques

 **...** | **al `r analyzing`** | **a la ciutat**
------------- | ------------- | -------------
 |  |  
Atur (estimació)[^1] | |
Renda familiar bruta disponible[^2] | |
  |  |  
  
[^1]: Disposem a nivell de barri de dades sobre la població i sobre el nombre d'aturats registrats.
Per calcular la taxa d'atur cal saber la taxa d'activitat (no disponible per barris) i el nombre d'aturats real (més alt que els registrats).
Per tant, cal fer una estimació aproximada. Usant com a referència dades de la EPA del 4rt trimestre de 2013,
hem multiplicat la població total per 0.51 per estimar la població activa i hem multiplicat l'atur registrat per 1.3 per estimar la població aturada.
                                                                                                              
[^2]: La renda familiar bruta disponible per barris és un índex en base a 100 que calcula el servei d'estadística de l'Ajuntament.




render("input.Rmd", "all")

### Versió de R i dels diferents paquets que han sigut utilitzats
```{r sessionInfo, include=TRUE, echo=TRUE, results='markup'}:
sessionInfo()
```